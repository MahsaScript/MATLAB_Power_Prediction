% Solve an Input-Output Fitting problem with a Neural Network
% Script generated by Neural Fitting app
% Created 16-Jun-2025 23:14:37
%
% This script assumes these variables are defined:
%
%   pv_real_data_3 - input data.
%   test_power_4 - target data.
clear;clc;close all;

x=readtable('pv_real_data.csv');
t=readtable('test_power.csv');

x=table2array(x);
t=table2array(t);
% x = pv_real_data_3';
% t = test_power_4';

% Choose a Training Function
% For a list of all training functions type: help nntrain
% 'trainlm' is usually fastest.
% 'trainbr' takes longer but may be better for challenging problems.
% 'trainscg' uses less memory. Suitable in low memory situations.
trainFcn = 'trainlm';  % Levenberg-Marquardt backpropagation.

% Create a Fitting Network
hiddenLayerSize = 10;
net = fitnet(hiddenLayerSize,trainFcn);

% Setup Division of Data for Training, Validation, Testing
net.divideParam.trainRatio = 70/100;
net.divideParam.valRatio = 15/100;
net.divideParam.testRatio = 15/100;

% Train the Network
[net,tr] = train(net,x,t);

% Test the Network
y = net(x);
e = gsubtract(t,y);
performance = perform(net,t,y)

% View the Network
view(net)

% Plots
% Uncomment these lines to enable various plots.
figure, plotperform(tr)
figure, plottrainstate(tr)
figure, ploterrhist(e)
figure, plotregression(t,y)
figure, plotfit(net,x,t)



clear;clc;close all;

figure;
x=[0,2,4,6,8,10,12,14];
y=[800,820,840,860,880,900,920,940];
plot(x,y);
title('تغییرات تایش');
ylabel('(irradiance)تابش');
xlabel('زمان');

figure;
x=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14];
y=[25,26,26,27, 27,28,28,29,29,30,30,31,31,32,32];
plot(x,y);
title('تغییرات دما');
ylabel('(temperature)دما');
xlabel('زمان');

figure;
x=[0,   20,   30   , 40   , 60, 80 ,100];
y=[0.5, 0.2,  0.05 , 0.03 , 0.03, 0.03, 0.03];
plot(x,y);
hold on;
y=[0.5, 0.22,  0.06 , 0.04 , 0.04, 0.04, 0.04];
plot(x,y,'yellow');
title('تاریخچه خطا');
ylabel('(MSE)خطا');
xlabel('(Epoch)دور ');
legend('خطای آزمایش', 'خطای اعتبار سنجی');



figure;
x=[25,26,27,28,29,30,31];
y=[25,26,27,28,29,30,31];
plot(x,y);
hold on,
x=[25.1,30,30.5];
y=[26.5,29,29.8];
plot(x,y,'.',MarkerSize=30);
title('تغییرات مقایسه ولتاژ');
ylabel('ولتاژپیش بینی شده');
xlabel('ولتاژواقعی');

figure;
x=[3.2,3.4, 3.6, 3.8,4.0,4.2,4.4];
y=[3.2,3.4, 3.6, 3.8,4.0,4.2,4.4];
plot(x,y);
hold on,
x=[3.23,4.2,4.3];
y=[3.5,4.1,4.2];
plot(x,y,'.',MarkerSize=30);
title('مقایسه جریان');
ylabel('ولتاژپیش بینی حریان پیش بینی شده');
xlabel('جریان واقعی');
xlim([3.2 , 4.4]);
ylim([3.2 , 4.4]);


figure;
x=[0.00, 0.25, 0.50, 0.75, 1.00, 1.25, 1.50, 1.75, 2.00];
y=[120, 124, 127, 129, 125, 117, 110, 100,90];
plot(x,y, Color='yellow');
hold on,
x=[0.00, 0.25, 0.50, 0.75, 1.00, 1.25, 1.50, 1.75, 2.00];
y=[125, 129, 133, 137, 125, 110, 100, 90,80];
plot(x,y,Color='blue');
title('مقایسه توان');
ylabel('(PV Power)توان');
xlabel('زمان-نمونه ها');
% xlim([3.2 , 4.4]);
ylim([80 , 140]);
legend('واقعی','پیش بینی شده');
